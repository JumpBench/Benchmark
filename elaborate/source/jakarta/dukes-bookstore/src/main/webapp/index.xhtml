<?xml version='1.0' encoding='UTF-8' ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="jakarta.faces.facelets"
                xmlns:h="jakarta.faces.html"
                xmlns:f="jakarta.faces.core"
                xmlns:bookstore="http://dukesbookstore"
                template="./bookstoreTemplate.xhtml">

    <ui:define name="top" />

    <ui:define name="content">
        <h:form id="mainForm">
            <h:panelGrid columns="1"
                         title="#{bundle.ChooseBook}">

                <h:outputText style="font-weight:bold"
                              value="#{bundle.ChooseBook}" />

                <!-- ✅ Ensure mapImage is wrapped in real components -->
                <h:panelGroup id="imageContainer"
                              layout="block">
                    <h:graphicImage id="mapImage"
                                    name="book_all.jpg"
                                    library="images"
                                    alt="#{bundle.ChooseBook}"
                                    usemap="#bookMap" />
                </h:panelGroup>
                <h:panelGroup rendered="#{not empty view.viewId}"> <!-- dummy render trigger -->
                    <h:graphicImage id="mapImage"
                                    name="book_all.jpg"
                                    library="images"
                                    alt="#{bundle.ChooseBook}"
                                    usemap="#bookMap" />
                </h:panelGroup>
                <!-- ✅ Your custom map component with area definitions -->
                <bookstore:map id="bookMap"
                               current="map1"
                               immediate="true"
                               action="bookstore">
                    <f:actionListener type="jakarta.tutorial.dukesbookstore.listeners.MapBookChangeListener" />

                    <bookstore:area id="map1"
                                    value="#{Book201}"
                                    onmouseover="resources/images/book_201.jpg"
                                    onmouseout="resources/images/book_all.jpg"
                                    targetImage="mapImage" />
                    <bookstore:area id="map2"
                                    value="#{Book202}"
                                    onmouseover="resources/images/book_202.jpg"
                                    onmouseout="resources/images/book_all.jpg"
                                    targetImage="mapImage" />
                    <bookstore:area id="map3"
                                    value="#{Book203}"
                                    onmouseover="resources/images/book_203.jpg"
                                    onmouseout="resources/images/book_all.jpg"
                                    targetImage="mapImage" />
                    <bookstore:area id="map4"
                                    value="#{Book205}"
                                    onmouseover="resources/images/book_205.jpg"
                                    onmouseout="resources/images/book_all.jpg"
                                    targetImage="mapImage" />
                    <bookstore:area id="map5"
                                    value="#{Book206}"
                                    onmouseover="resources/images/book_206.jpg"
                                    onmouseout="resources/images/book_all.jpg"
                                    targetImage="mapImage" />
                    <bookstore:area id="map6"
                                    value="#{Book207}"
                                    onmouseover="resources/images/book_207.jpg"
                                    onmouseout="resources/images/book_all.jpg"
                                    targetImage="mapImage" />
                </bookstore:map>

            </h:panelGrid>
        </h:form>
    </ui:define>
</ui:composition>